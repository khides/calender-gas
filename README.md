# Google Calendar Sync - Google Apps Script

è¤‡æ•°ã®Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’1ã¤ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«è‡ªå‹•åŒæœŸã™ã‚‹Google Apps Scriptã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

## æ¦‚è¦

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€è¤‡æ•°ã®Gmailã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆB, C, D...ï¼‰ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼äºˆå®šã‚’ã€1ã¤ã®ãƒ¡ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆAï¼‰ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«è‡ªå‹•çš„ã«åŒæœŸã—ã¾ã™ã€‚

```
Account B ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ â”€â”€â”
Account C ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ â”€â”€â”¼â”€â”€â–¶ Account A ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
Account D ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ â”€â”€â”˜
```

## æ©Ÿèƒ½

- **è‡ªå‹•åŒæœŸ**: 15åˆ†é–“éš”ã®å®šæœŸåŒæœŸ + ã‚¤ãƒ™ãƒ³ãƒˆå¤‰æ›´æ™‚ã®å³åº§åŒæœŸ
- **å¢—åˆ†åŒæœŸ**: sync tokenã‚’ä½¿ç”¨ã—ãŸåŠ¹ç‡çš„ãªå·®åˆ†åŒæœŸ
- **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ‰**:
  - `busy`: ã€Œäºˆå®šã‚ã‚Šã€ã®ã¿è¡¨ç¤º
  - `title-only`: ã‚¿ã‚¤ãƒˆãƒ«ã¨æ™‚é–“ã®ã¿
  - `full`: å…¨æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼
- **ã‚¤ãƒ™ãƒ³ãƒˆè¿½è·¡**: ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã‚’å®Œå…¨åŒæœŸ
- **ã‚«ãƒ©ãƒ¼åˆ†ã‘**: ã‚½ãƒ¼ã‚¹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã”ã¨ã«è‰²ã‚’è¨­å®šå¯èƒ½

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é † (Claspç‰ˆ - æ¨å¥¨)

Claspã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚

### å‰ææ¡ä»¶

- Node.js >= 22.0.0
- npm

### Step 1: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®å…±æœ‰è¨­å®š

å„ã‚½ãƒ¼ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆB, C, D...ï¼‰ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:

1. [Google Calendar](https://calendar.google.com) ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã€**â‹®** â†’ **è¨­å®šã¨å…±æœ‰** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€Œç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¾ãŸã¯ã‚°ãƒ«ãƒ¼ãƒ—ã¨å…±æœ‰ã™ã‚‹ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ **+ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ ** ã‚’ã‚¯ãƒªãƒƒã‚¯
4. Account A ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›
5. æ¨©é™ã‚’ **ã€Œäºˆå®šã®è¡¨ç¤ºï¼ˆã™ã¹ã¦ã®äºˆå®šã®è©³ç´°ï¼‰ã€** ã«è¨­å®š
6. **é€ä¿¡** ã‚’ã‚¯ãƒªãƒƒã‚¯

### Step 2: äº‹å‰æº–å‚™ (Account Aã§1å›ã®ã¿)

1. [Apps Script API](https://script.google.com/home/usersettings) ã‚’æœ‰åŠ¹åŒ–
2. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ & ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:

```bash
git clone https://github.com/khides/calender-gas.git
cd calender-gas
npm install
```

3. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³:

```bash
npm run login
```

### Step 3: ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
npm run create

# ã‚³ãƒ¼ãƒ‰ã‚’ãƒ—ãƒƒã‚·ãƒ¥ & Calendar APIæœ‰åŠ¹åŒ–
npm run deploy

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã
npm run open
```

### Step 4: è¨­å®šã¨åˆå›åŒæœŸ (ãƒ–ãƒ©ã‚¦ã‚¶ã®Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ã§å®Ÿæ–½)

`npm run open` ã§Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ãŒé–‹ãã¾ã™ã€‚

#### 4-1. ã‚½ãƒ¼ã‚¹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®è¨­å®š

1. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ **Config.gs** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. `sourceCalendars` é…åˆ—å†…ã® `calendarId` ã‚’å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›´:

```javascript
calendarId: 'your-actual-account@gmail.com',  // â† å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«ã«å¤‰æ›´
```

3. **è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åŒæœŸã™ã‚‹å ´åˆ**: ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã‚’å‚è€ƒã«ã€ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ãã ã•ã„

```javascript
sourceCalendars: [
  {
    calendarId: 'account-b@gmail.com',
    label: 'Account B',
    privacyMode: 'busy',
    enabled: true,
    colorId: '1'
  },
  {  // â† ã‚«ãƒ³ãƒã‚’å¿˜ã‚Œãšã«è¿½åŠ 
    calendarId: 'account-c@gmail.com',
    label: 'Account C',
    privacyMode: 'busy',
    enabled: true,
    colorId: '2'
  }
]
```

#### 4-2. é–¢æ•°ã®å®Ÿè¡Œæ–¹æ³•

Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ã§é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯:

1. ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šéƒ¨ã® **é–¢æ•°é¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³** (ã€Œé–¢æ•°ã‚’é¸æŠã€ã¨è¡¨ç¤º) ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å®Ÿè¡Œã—ãŸã„é–¢æ•°åã‚’é¸æŠ
3. **å®Ÿè¡Œãƒœã‚¿ãƒ³ (â–¶)** ã‚’ã‚¯ãƒªãƒƒã‚¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [é–¢æ•°ã‚’é¸æŠ â–¼]  [â–¶ å®Ÿè¡Œ]  [ğŸ› ãƒ‡ãƒãƒƒã‚°]              â”‚
â”‚                                                         â”‚
â”‚  â†‘ ã“ã“ã§é–¢æ•°ã‚’é¸ã‚“ã§å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã™                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4-3. åˆæœŸè¨­å®šã®å®Ÿè¡Œ

ä»¥ä¸‹ã®é †ç•ªã§é–¢æ•°ã‚’å®Ÿè¡Œ:

1. `Code.gs`ã®**`validateSetup`** ã‚’é¸æŠã—ã¦å®Ÿè¡Œ
   - åˆå›ã¯æ¨©é™ã®æ‰¿èªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   - ã€Œæ¨©é™ã‚’ç¢ºèªã€â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠ â†’ ã€Œè©³ç´°ã€â†’ ã€Œå®‰å…¨ã§ã¯ãªã„ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã€â†’ ã€Œè¨±å¯ã€
   - å®Ÿè¡Œãƒ­ã‚° (ä¸‹éƒ¨ãƒ‘ãƒãƒ«) ã§ã€Œã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°OK

2. **`setupTriggers`** ã‚’é¸æŠã—ã¦å®Ÿè¡Œ
   - è‡ªå‹•åŒæœŸã®ãƒˆãƒªã‚¬ãƒ¼ãŒè¨­å®šã•ã‚Œã‚‹

3. **`manualSync`** ã‚’é¸æŠã—ã¦å®Ÿè¡Œ
   - åˆå›ã®åŒæœŸãŒå®Ÿè¡Œã•ã‚Œã‚‹
   - Account A ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šãŒåŒæœŸã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

### npm ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `npm run login` | Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ |
| `npm run create` | GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ |
| `npm run push` | ã‚³ãƒ¼ãƒ‰ã‚’ãƒ—ãƒƒã‚·ãƒ¥ |
| `npm run deploy` | ãƒ—ãƒƒã‚·ãƒ¥ + APIæœ‰åŠ¹åŒ– |
| `npm run open` | ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ã |
| `npm run watch` | ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’ç›£è¦–ã—ã¦è‡ªå‹•ãƒ—ãƒƒã‚·ãƒ¥ |

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é † (æ‰‹å‹•ç‰ˆ)

Claspã‚’ä½¿ç”¨ã—ãªã„å ´åˆã®æ‰‹é †ã§ã™ã€‚

### Step 1: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®å…±æœ‰è¨­å®š

(Claspç‰ˆã¨åŒã˜)

### Step 2: GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

Account A ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:

1. [Google Apps Script](https://script.google.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã€ŒCalendar Syncã€ã«å¤‰æ›´

### Step 3: Advanced Calendar APIã®æœ‰åŠ¹åŒ–

1. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® **ã‚µãƒ¼ãƒ“ã‚¹** ã®æ¨ªã«ã‚ã‚‹ **+** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **Google Calendar API** ã‚’é¸æŠ
3. **è¿½åŠ ** ã‚’ã‚¯ãƒªãƒƒã‚¯

### Step 4: ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ä»¥ä¸‹ã®å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€å¯¾å¿œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼:

| ãƒ•ã‚¡ã‚¤ãƒ«å | èª¬æ˜ |
|-----------|------|
| `appsscript.json` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ |
| `Config.gs` | è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« |
| `Code.gs` | ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ |
| `SyncEngine.gs` | åŒæœŸã‚¨ãƒ³ã‚¸ãƒ³ |
| `EventMapper.gs` | ã‚¤ãƒ™ãƒ³ãƒˆå¤‰æ› |
| `StorageManager.gs` | çŠ¶æ…‹ç®¡ç† |
| `Logger.gs` | ãƒ­ã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ |
| `Triggers.gs` | ãƒˆãƒªã‚¬ãƒ¼ç®¡ç† |
| `Utils.gs` | ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° |

**æ³¨æ„**: `appsscript.json` ã‚’ç·¨é›†ã™ã‚‹ã«ã¯:
1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š** (æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³) ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **ã€Œappsscript.jsonã€ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ãƒ‡ã‚£ã‚¿ã§è¡¨ç¤ºã™ã‚‹** ã«ãƒã‚§ãƒƒã‚¯
3. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã« `appsscript.json` ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### Step 5: è¨­å®šã®ç·¨é›†

`Config.gs` ã‚’é–‹ãã€`calendarId` ã‚’å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›´:

```javascript
sourceCalendars: [
  {
    calendarId: 'your-actual-account@gmail.com',  // â† å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«ã«å¤‰æ›´
    label: 'Account B',
    privacyMode: 'busy',
    enabled: true,
    colorId: '1'
  }
  // è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åŒæœŸã™ã‚‹å ´åˆã¯ã€ä¸Šè¨˜ã‚’å‚è€ƒã«ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ 
]
```

**æ³¨æ„**:
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯1ã¤ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã¿è¨­å®šã•ã‚Œã¦ã„ã¾ã™
- è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åŒæœŸã™ã‚‹å ´åˆã¯ã€Config.gså†…ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- å„ã‚¨ãƒ³ãƒˆãƒªã®é–“ã«ã¯ã‚«ãƒ³ãƒ (`,`) ãŒå¿…è¦ã§ã™

### Step 6: æ¤œè¨¼ã¨æ¨©é™ä»˜ä¸

1. **é–¢æ•°ã‚’é¸æŠ** ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§ `validateSetup` ã‚’é¸æŠ
2. **å®Ÿè¡Œ** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æ¨©é™ã®ç¢ºèªç”»é¢ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰:
   - **æ¨©é™ã‚’ç¢ºèª** ã‚’ã‚¯ãƒªãƒƒã‚¯
   - Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠ
   - **è©³ç´°** â†’ **[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå] ã«ç§»å‹•ï¼ˆå®‰å…¨ã§ã¯ãªã„ãƒšãƒ¼ã‚¸ï¼‰** ã‚’ã‚¯ãƒªãƒƒã‚¯
   - **è¨±å¯** ã‚’ã‚¯ãƒªãƒƒã‚¯
4. å®Ÿè¡Œãƒ­ã‚°ã§å…¨ã¦ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãŒã€Œã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### Step 7: ãƒˆãƒªã‚¬ãƒ¼ã®è¨­å®š

1. **é–¢æ•°ã‚’é¸æŠ** ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§ `setupTriggers` ã‚’é¸æŠ
2. **å®Ÿè¡Œ** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. å®Ÿè¡Œãƒ­ã‚°ã§ãƒˆãƒªã‚¬ãƒ¼ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª

### Step 8: åˆå›åŒæœŸ

1. **é–¢æ•°ã‚’é¸æŠ** ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§ `manualSync` ã‚’é¸æŠ
2. **å®Ÿè¡Œ** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. Account A ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šãŒåŒæœŸã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

## åˆ©ç”¨å¯èƒ½ãªé–¢æ•°

| é–¢æ•° | èª¬æ˜ |
|------|------|
| `manualSync()` | æ‰‹å‹•ã§åŒæœŸã‚’å®Ÿè¡Œ |
| `validateSetup()` | è¨­å®šã¨ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æ¤œè¨¼ |
| `setupTriggers()` | è‡ªå‹•ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®š |
| `clearTriggers()` | å…¨ãƒˆãƒªã‚¬ãƒ¼ã‚’å‰Šé™¤ |
| `showStatus()` | åŒæœŸçŠ¶æ…‹ã‚’è¡¨ç¤º |
| `forceFullSync()` | å…¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãƒ•ãƒ«ã‚·ãƒ³ã‚¯ã‚’å®Ÿè¡Œ |
| `resetAllData()` | å…¨ã¦ã®åŒæœŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ |
| `removeAllSyncedEvents()` | åŒæœŸã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’å…¨å‰Šé™¤ |

## è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

### ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ‰

| ãƒ¢ãƒ¼ãƒ‰ | è¡¨ç¤ºå†…å®¹ |
|--------|---------|
| `busy` | ã€Œ[ãƒ©ãƒ™ãƒ«] äºˆå®šã‚ã‚Šã€ã®ã¿è¡¨ç¤º |
| `title-only` | ã‚¿ã‚¤ãƒˆãƒ«ã¨æ™‚é–“ã®ã¿ï¼ˆèª¬æ˜ãƒ»å ´æ‰€ãªã—ï¼‰ |
| `full` | å…¨ã¦ã®æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ |

### ã‚«ãƒ©ãƒ¼ID

| ID | è‰² |
|----|-----|
| 1 | ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼ |
| 2 | ã‚»ãƒ¼ã‚¸ |
| 3 | ãƒ–ãƒ‰ã‚¦ |
| 4 | ãƒ•ãƒ©ãƒŸãƒ³ã‚´ |
| 5 | ãƒãƒŠãƒŠ |
| 6 | ã¿ã‹ã‚“ |
| 7 | ãƒ”ãƒ¼ã‚³ãƒƒã‚¯ |
| 8 | ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ |
| 9 | ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼ |
| 10 | ãƒã‚¸ãƒ« |
| 11 | ãƒˆãƒãƒˆ |

## ã‚¯ã‚©ãƒ¼ã‚¿ã¨åˆ¶é™

| é …ç›® | åˆ¶é™ | å¯¾ç­– |
|------|------|------|
| ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ/æ—¥ | 5,000 | å¢—åˆ†åŒæœŸã§æœ€å°åŒ– |
| ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œæ™‚é–“ | 6åˆ† | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ |
| ãƒˆãƒªã‚¬ãƒ¼å®Ÿè¡Œæ™‚é–“/æ—¥ | 90åˆ† | sync tokenã§åŠ¹ç‡åŒ– |

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

1. ã‚½ãƒ¼ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãŒæ­£ã—ãå…±æœ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. Account A ãŒã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’è³¼èª­ã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆCalendar > ä»–ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ > è³¼èª­ï¼‰
3. `Config.gs` ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼IDãŒæ­£ã—ã„ã‹ç¢ºèª

### åŒæœŸãŒå‹•ä½œã—ãªã„

1. `showStatus()` ã‚’å®Ÿè¡Œã—ã¦çŠ¶æ…‹ã‚’ç¢ºèª
2. ãƒˆãƒªã‚¬ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. å®Ÿè¡Œãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

### sync tokenã‚¨ãƒ©ãƒ¼

```
sync tokenç„¡åŠ¹åŒ–ã€ãƒ•ãƒ«ã‚·ãƒ³ã‚¯å®Ÿè¡Œ
```

ã“ã‚Œã¯æ­£å¸¸ãªå‹•ä½œã§ã™ã€‚GoogleãŒãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆã—ãŸãŸã‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãƒ•ãƒ«ã‚·ãƒ³ã‚¯ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ãŸã“ã¨ã‚’UPç¤ºã—ã¾ã™ã€‚

## ã‚µãƒãƒ¼ãƒˆ

 [GitHub Issues](https://github.com/khides/calender-sync-gas/issues/new) ã¾ãŸã¯ [ãƒ•ã‚©ãƒ¼ãƒ ](https://khides.com/ja/contact) ã‹ã‚‰ãŠé¡˜ã„ã—ã¾ã™ã€‚

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## å‚è€ƒè³‡æ–™

- [Calendar Service | Apps Script](https://developers.google.com/apps-script/reference/calendar)
- [Advanced Calendar Service](https://developers.google.com/apps-script/advanced/calendar)
- [Calendar Sync Tokens](https://developers.google.com/workspace/calendar/api/guides/sync)
