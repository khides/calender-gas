<mxfile host="app.diagrams.net" modified="2026-01-10T00:00:00.000Z" agent="Draw.io" version="22.0.0" etag="calender-sync-gas-architecture" type="device">
  <diagram id="architecture" name="System Architecture">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="700" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Google Apps Script Environment -->
        <mxCell id="gas-env" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="40" width="900" height="520" as="geometry" />
        </mxCell>
        <mxCell id="gas-label" value="Google Apps Script Execution Environment" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="120" y="50" width="300" height="30" as="geometry" />
        </mxCell>

        <!-- Triggers Section -->
        <mxCell id="triggers-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="90" width="500" height="80" as="geometry" />
        </mxCell>
        <mxCell id="triggers-label" value="Triggers" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#1976D2;" vertex="1" parent="1">
          <mxGeometry x="510" y="95" width="80" height="20" as="geometry" />
        </mxCell>

        <!-- Time-based Trigger -->
        <mxCell id="time-trigger" value="â° Time-based&#xa;(Every 15 min)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#BBDEFB;strokeColor=#1976D2;strokeWidth=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="340" y="120" width="120" height="40" as="geometry" />
        </mxCell>

        <!-- Event-based Trigger -->
        <mxCell id="event-trigger" value="ðŸ“… Calendar Change&#xa;(Immediate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#BBDEFB;strokeColor=#1976D2;strokeWidth=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="640" y="120" width="120" height="40" as="geometry" />
        </mxCell>

        <!-- Entry Points -->
        <mxCell id="runsync" value="runSync()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;strokeWidth=2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oncalchange" value="onCalendarChange()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;strokeWidth=2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="200" width="120" height="40" as="geometry" />
        </mxCell>

        <!-- Arrows from triggers to entry points -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="time-trigger" target="runsync">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="event-trigger" target="oncalchange">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- SyncEngine (Core) -->
        <mxCell id="syncengine" value="ðŸ”„ SyncEngine&#xa;(Core Logic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;strokeWidth=3;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="475" y="280" width="150" height="60" as="geometry" />
        </mxCell>

        <!-- Arrows to SyncEngine -->
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;entryX=0.25;entryY=0;" edge="1" parent="1" source="runsync" target="syncengine">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;entryX=0.75;entryY=0;" edge="1" parent="1" source="oncalchange" target="syncengine">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Modules Row -->
        <mxCell id="eventmapper" value="ðŸ”€ EventMapper&#xa;(Transform)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="240" y="380" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="storagemanager" value="ðŸ’¾ StorageManager&#xa;(State Persistence)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="485" y="380" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="logger" value="ðŸ“ Logger&#xa;(Output)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="730" y="380" width="130" height="50" as="geometry" />
        </mxCell>

        <!-- Arrows from SyncEngine to modules -->
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="syncengine" target="eventmapper">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="syncengine" target="storagemanager">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="syncengine" target="logger">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Google Calendar API -->
        <mxCell id="calapi" value="Google Calendar API v3&#xa;(Advanced Service)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFECB3;strokeColor=#FFA000;strokeWidth=2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="350" y="470" width="200" height="50" as="geometry" />
        </mxCell>

        <!-- Script Properties -->
        <mxCell id="scriptprops" value="Script Properties&#xa;(Sync Tokens, Event Map)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFECB3;strokeColor=#FFA000;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="600" y="470" width="160" height="50" as="geometry" />
        </mxCell>

        <!-- Arrows to API and Properties -->
        <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="eventmapper" target="calapi">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="storagemanager" target="scriptprops">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- External Calendars -->
        <mxCell id="source-cals" value="ðŸ“… Source Calendars&#xa;(Account B, C, D...)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;strokeWidth=2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="180" y="590" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dest-cal" value="ðŸ“… Destination Calendar&#xa;(Account A - Primary)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;strokeWidth=2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="590" width="180" height="60" as="geometry" />
        </mxCell>

        <!-- Sync Arrow -->
        <mxCell id="sync-arrow" value="" style="endArrow=classic;startArrow=none;html=1;rounded=0;strokeWidth=3;strokeColor=#F57C00;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="source-cals" target="dest-cal">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="620" as="sourcePoint" />
            <mxPoint x="450" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sync-label" value="Sync" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1;fontColor=#F57C00;" vertex="1" connectable="0" parent="sync-arrow">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Arrow from API to Calendars -->
        <mxCell id="arrow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;entryX=0.5;entryY=0;exitX=0.25;exitY=1;" edge="1" parent="1" source="calapi" target="source-cals">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;entryX=0.5;entryY=0;exitX=0.75;exitY=1;" edge="1" parent="1" source="calapi" target="dest-cal">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
